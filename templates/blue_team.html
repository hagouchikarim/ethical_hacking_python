<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blue Team – SOC</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
</head>
<body class="blue-team-body">

<!-- ─── NAV ─── -->
<nav class="top-nav">
    <div class="nav-content">
        <a href="/" class="nav-logo"><i class="fas fa-shield-alt"></i> Blue Team</a>
        <div class="nav-links">
            <span class="snort-pill" id="snortPill"><i class="fas fa-circle snort-dot"></i> Snort</span>
            <a href="/" class="nav-link"><i class="fas fa-home"></i> Home</a>
            <a href="/red-team" class="nav-link"><i class="fas fa-crosshairs"></i> Red Team</a>
        </div>
    </div>
</nav>

<div class="container">

<!-- ─── 1. METRICS ─── -->
<section class="section">
    <div class="metrics-row">
        <div class="metric-card">
            <div class="metric-icon security-score"><i class="fas fa-shield-alt"></i></div>
            <div class="metric-content"><h3 id="securityScore">100</h3><p>Security Score</p></div>
        </div>
        <div class="metric-card">
            <div class="metric-icon active-threats"><i class="fas fa-exclamation-triangle"></i></div>
            <div class="metric-content"><h3 id="activeThreats">0</h3><p>Active Threats</p></div>
        </div>
        <div class="metric-card">
            <div class="metric-icon total-alerts"><i class="fas fa-bell"></i></div>
            <div class="metric-content"><h3 id="totalAlerts">0</h3><p>IDS Alerts</p></div>
        </div>
        <div class="metric-card">
            <div class="metric-icon snort-metric"><i class="fas fa-bug"></i></div>
            <div class="metric-content"><h3 id="snortAlertCount">0</h3><p>Snort Detections</p></div>
        </div>
        <div class="metric-card">
            <div class="metric-icon blocked-attacks"><i class="fas fa-ban"></i></div>
            <div class="metric-content"><h3 id="blockedAttacks">0</h3><p>Blocked IPs</p></div>
        </div>
    </div>
    <div class="status-row">
        <span class="status-indicator" id="systemStatus"><i class="fas fa-circle"></i> Operational</span>
    </div>
</section>

<!-- ─── 2. LIVE ALERT FEED ─── -->
<section class="section">
    <div class="section-head">
        <h2 class="section-title"><i class="fas fa-eye"></i> Live Alert Feed</h2>
        <div class="filter-row">
            <button class="pill active" data-filter="all">All</button>
            <button class="pill" data-filter="snort">Snort</button>
            <button class="pill" data-filter="ids">IDS</button>
            <select id="feedSeverity" class="form-control sel">
                <option value="">All Severities</option>
                <option value="Critical">Critical</option>
                <option value="High">High</option>
                <option value="Medium">Medium</option>
                <option value="Low">Low</option>
            </select>
        </div>
    </div>
    <div class="alert-list" id="alertFeed">
        <div class="empty-state"><i class="fas fa-shield-alt"></i> Monitoring… no alerts yet</div>
    </div>
</section>

<!-- ─── 3. FIREWALL ─── -->
<section class="section">
    <div class="section-head">
        <h2 class="section-title"><i class="fas fa-fire"></i> Firewall</h2>
        <button class="btn btn-blue btn-small" id="addFirewallRuleBtn"><i class="fas fa-plus"></i> Add Rule</button>
    </div>
    <div class="fw-layout">
        <div class="rules-list" id="firewallRulesList"></div>
        <div class="fw-block-strip">
            <div class="block-input-row">
                <input type="text" id="blockIPInput" class="form-control" placeholder="IP to block…">
                <button class="btn btn-red btn-small" id="blockIPBtn"><i class="fas fa-ban"></i> Block</button>
            </div>
            <div class="blocked-ips-list" id="blockedIPsList"></div>
        </div>
    </div>
</section>

<!-- ─── 4. IDS RULES ─── -->
<section class="section">
    <div class="section-head">
        <h2 class="section-title"><i class="fas fa-search"></i> IDS Rules</h2>
        <button class="btn btn-blue btn-small" id="addRuleBtn"><i class="fas fa-plus"></i> Add Rule</button>
    </div>
    <div class="rules-list" id="rulesList"></div>
</section>

<!-- ─── 5. SYSTEM LOGS ─── -->
<section class="section">
    <div class="section-head">
        <h2 class="section-title"><i class="fas fa-terminal"></i> System Logs</h2>
        <div class="filter-row">
            <input type="text" id="logSearch" class="form-control search-input" placeholder="Search…">
            <select id="logTypeFilter" class="form-control sel">
                <option value="">All Types</option>
                <option value="attack">Attack</option>
                <option value="system">System</option>
            </select>
            <button class="btn btn-small" id="clearLogsBtn"><i class="fas fa-trash"></i></button>
        </div>
    </div>
    <div class="log-viewer" id="logViewer"></div>
</section>

<!-- ─── 6. SOC REPORT ─── -->
<section class="section report-section">
    <div class="section-head">
        <h2 class="section-title"><i class="fas fa-file-chart-line"></i> SOC Audit Report</h2>
    </div>
    <p class="report-desc">Full incident report: every Snort &amp; IDS alert, firewall actions, blocked sources, attack-to-detection correlation, and per-threat prevention &amp; blocking recommendations.</p>
    <div class="report-btns">
        <button class="btn btn-blue" id="generateAuditReport"><i class="fas fa-file-pdf"></i> Generate PDF</button>
        <button class="btn btn-small" id="exportReportJSON"><i class="fas fa-file-code"></i> Export JSON</button>
    </div>
</section>

</div>
<script src="{{ url_for('static', filename='js/blue_team.js') }}"></script>
</body>
</html>